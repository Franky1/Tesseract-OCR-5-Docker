name: Schedule

on:
  schedule:
    # Runs "at 03:13 every day" (see https://crontab.guru)
    - cron: '3 13 * * *'
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  Schedule:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v2
      - name: Show Python Version
        run: python --version
      - name: Install PyGithub
        run: pip install --upgrade PyGithub
      - name: Run python script to check for updates
        run: python versioncheck.py
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - name: run job for main branch
        if: hashFiles('MAIN.json') != ''
        run: echo "Update MAIN necessary"
        uses: ./.github/workflows/build-main.yml@main
        with:
          TAG: latest
          BRANCH: main
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      - name: run job for release
        if: hashFiles('RELEASE.json') != ''
        run: echo "Update RELEASE necessary"
        # uses: ./.github/workflows/build-release.yml@main
        # with:
        #   TAG: latest
        #   BRANCH: main
        #   GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        #   SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
